<!DOCTYPE html>
<html lang="en">
<head>
    <title>Netflix UI - Pro Advanced Features</title>
    <meta charset="UTF-8" />
    <style>
        body { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background: #000; margin: 0; padding: 20px; }
        
        .netflix-header {
            position: absolute; top: 0; left: 0; right: 0;
            padding: 30px; background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
            z-index: 100; display: flex; align-items: center; gap: 20px;
            opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .art-state-show .netflix-header { opacity: 1; visibility: visible; }
        .back-arrow { width: 30px; height: 30px; fill: white; cursor: pointer; }
        .movie-title { color: white; font-size: 20px; font-weight: 500; }

        .artplayer-app {
            width: 100%;
            max-width: 900px;
            height: 506px;
            margin: 0 auto;
            background: #000;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .netflix-overlay {
            position: absolute; inset: 0;
            display: flex; align-items: center; justify-content: center;
            gap: 100px; z-index: 50;
            pointer-events: none; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s;
        }
        .art-state-show .netflix-overlay { opacity: 1; visibility: visible; }
        .netflix-btn { pointer-events: auto; cursor: pointer; }
        .netflix-btn svg { width: 55px; height: 55px; fill: #fff; }
        .netflix-btn.play-center svg { width: 90px; height: 90px; }

        .art-loading .netflix-spinner {
            width: 60px;
            height: 60px;
            animation: netflix-rotate 1.1s linear infinite;
        }
        @keyframes netflix-rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>

<body>

<div class="artplayer-app">
    <div class="netflix-header">
        <svg class="back-arrow" viewBox="0 0 24 24" onclick="history.back()">
            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"/>
        </svg>
        <div class="movie-title" id="titleText">Waiting for title</div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@swarmcloud/hls/hls.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/artplayer@5.0.9/dist/artplayer.js"></script>

<script>
(async () => {

    const params = new URLSearchParams(location.search);
    const title = params.get("title");

    const titleText = document.getElementById("titleText");

    if (!title) {
        titleText.innerText = "No title provided";
        return;
    }

    titleText.innerText = title.replaceAll('.', ' ');

    /* Fetch Render API THROUGH proxy */
    const renderApi =
        "https://workingg.vercel.app/api/proxy?url=" +
        encodeURIComponent(
            "https://u-1-1azw.onrender.com/api/get-stream?title=" + title
        );

    const res = await fetch(renderApi);
    const json = await res.json();

    if (!json?.m3u8_url) {
        titleText.innerText = "Stream not found";
        return;
    }

    const m3u8Url =
        "https://workingg.vercel.app/api/proxy?url=" +
        encodeURIComponent(json.m3u8_url);

    /* ICONS */
    const iconBack = `<svg viewBox="0 0 24 24"><path d="M11 18l-7-6 7-6v12z"/></svg>`;
    const iconForward = `<svg viewBox="0 0 24 24"><path d="M13 6l7 6-7 6V6z"/></svg>`;
    const iconPlay = `<svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>`;
    const iconPause = `<svg viewBox="0 0 24 24"><path d="M6 19h4V5H6zm8-14v14h4V5z"/></svg>`;

    const art = new Artplayer({
        container: '.artplayer-app',
        url: m3u8Url,
        type: 'm3u8',
        fullscreen: true,
        fullscreenWeb: true,
        autoSize: true,
        setting: true,
        loop: true,
        flip: true,
        playbackRate: true,
        aspectRatio: true,
        screenshot: true,
        pip: true,
        miniProgressBar: true,
        mutex: true,
        backdrop: true,
        playsInline: true,
        autoplay: true,
        airplay: true,
        lock: true,
        fastForward: true,
        subtitleOffset: true,
        theme: '#e50914',
        icons: {
            loading: '<img class="netflix-spinner" src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png">',
        },
        layers: [{
            name: 'netflix-center',
            html: `
                <div class="netflix-overlay">
                    <div class="netflix-btn back-10">${iconBack}</div>
                    <div class="netflix-btn play-center">${iconPlay}</div>
                    <div class="netflix-btn forward-10">${iconForward}</div>
                </div>`
        }],
        customType: {
            m3u8(video, url, art) {
                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(video);
                    art.hls = hls;

                    hls.on(Hls.Events.MANIFEST_PARSED, () => {
                        art.setting.add({
                            name: 'quality',
                            html: 'Quality',
                            selector: [
                                { default: true, html: 'Auto', level: -1 },
                                ...hls.levels.map((l, i) => ({ html: l.height + 'p', level: i }))
                            ],
                            onSelect: item => (hls.currentLevel = item.level, item.html)
                        });
                    });
                }
            }
        }
    });

    art.on('ready', () => {
        const playBtn = document.querySelector('.play-center');
        const backBtn = document.querySelector('.back-10');
        const forwardBtn = document.querySelector('.forward-10');

        playBtn.onclick = () => art.toggle();
        backBtn.onclick = () => art.currentTime -= 10;
        forwardBtn.onclick = () => art.currentTime += 10;

        art.on('play', () => playBtn.innerHTML = iconPause);
        art.on('pause', () => playBtn.innerHTML = iconPlay);
    });

})();
</script>

</body>
</html
